<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ks49team01.admin.mapper.AdminUserMapper">


	<resultMap type="AdminUser" id="usersResultMap">
		<id 	column="member_id" 		property="memberId" />
		<result column="member_pw" 		property="memberPw"/>
		<result column="member_name" 		property="memberName"/>
		<result column="member_email" 		property="memberEmail"/>
		<result column="member_birth" 		property="memberBirth"/>
		<result column="member_gender" 		property="memberGender"/>
		<result column="member_phone" 		property="memberPhone"/>
		<result column="member_addr" 		property="memberAddr"/>
		<result column="member_regdate" 		property="memberRegDate"/>
		
		
		<result column="final_mileage" 		property="final_mileage"/>
		<result column="accumulated_payment_amount" 		property="accumulated_payment_amount"/>
		<result column="memberState" 		property="memberState"/>
		<result column="mem_level_code" 		property="mem_level_code"/>
		<result column="membership_rating" 		property="membership_rating"/>
		
	</resultMap>
	
		<select id="getSearchForUserList" resultMap="usersResultMap">
		SELECT
			m.member_id,
			m.member_pw,
			m.member_name,
			m.member_email,
			m.member_birth,
			m.member_gender,
			m.member_phone,
			m.member_addr,
			m.member_regdate,
			m.final_mileage
		FROM
				member AS m
	<where>
			<if test="searchKey != null and searchKey != ''">
				<choose>
					<otherwise>					
						${searchKey} LIKE CONCAT('%', #{searchValue}, '%')
					</otherwise>
				</choose>
			</if>
		</where>
	</select>
	
<insert id="addMember" parameterType="AdminUser">
    <!-- 회원가입 -->
    INSERT INTO member
    (member_id, mem_level_code, membership_rating, member_pw, member_email, member_name, member_birth,
    member_gender, member_phone, member_addr, member_regdate, final_mileage,
    accumulated_payment_amount, memberState)
    VALUES
    (#{memberId}, #{mem_level_code}, #{membership_rating}, #{memberPw}, #{memberEmail}, #{memberName},
    #{memberBirth}, #{memberGender}, #{memberPhone}, #{memberAddr}, CURDATE(), #{final_mileage},
    #{accumulated_payment_amount}, #{memberState});
</insert>

	
	<select id="getuserList" resultMap="usersResultMap">
		SELECT
			m.member_id,
			m.member_pw,
			m.member_name,
			member_email,
			member_birth,
			member_gender,
			member_phone,
			member_addr,
			member_regdate,
			final_mileage
		FROM
			member AS m
		<!--SELECT
			m.member_id,
			m.member_pw,
			m.member_name
		FROM
			member AS m-->
	</select>
</mapper>
	